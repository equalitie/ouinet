def loadCmakeArgs() {
    def envVarPrefix = "CMAKEARG_"
    def allowedArguments = ['CMAKE_BUILD_TYPE', 'WITH_ASAN', 'WITH_EXPERIMENTAL', 'WITH_DEPRECATED']

    def cmakeArgs = []
    for (envVarName in allowedArguments) {
        def envVarValue = System.getenv(envVarPrefix + envVarName)
        if (envVarValue && envVarValue != "") {
            def cmakeArgName = envVarName.replaceFirst("^${envVarPrefix}", "")
            cmakeArgs.add("-D${cmakeArgName}=${envVarValue}")
        }
    }
    cmakeArgs
}

ext.cmakeExtraArguments = loadCmakeArgs()
